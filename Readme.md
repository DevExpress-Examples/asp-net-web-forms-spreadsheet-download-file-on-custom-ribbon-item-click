<!-- default badges list -->
![](https://img.shields.io/endpoint?url=https://codecentral.devexpress.com/api/v1/VersionRange/134059990/18.1.10%2B)
[![](https://img.shields.io/badge/Open_in_DevExpress_Support_Center-FF7200?style=flat-square&logo=DevExpress&logoColor=white)](https://supportcenter.devexpress.com/ticket/details/T623622)
[![](https://img.shields.io/badge/ðŸ“–_How_to_use_DevExpress_Examples-e9f6fc?style=flat-square)](https://docs.devexpress.com/GeneralInformation/403183)
<!-- default badges end -->
# ASPxSpreadsheet - How to download a document on custom RibbonItem click
<!-- run online -->
**[[Run Online]](https://codecentral.devexpress.com/t623622/)**
<!-- run online end -->


<p>This example illustrates how to download a file on a custom RibbonItem click. The item is added in code behind toÂ the existing ribbon tabs. The tabs are generated by the <a href="https://documentation.devexpress.com/AspNet/DevExpress.Web.ASPxSpreadsheet.ASPxSpreadsheet.CreateDefaultRibbonTabs.method">ASPxSpreadsheet.CreateDefaultRibbonTabs</a>Â method:</p>


```cs
  Spreadsheet.CreateDefaultRibbonTabs(true);
  RibbonButtonItem item = new RibbonButtonItem("Download", "Download");
  Spreadsheet.RibbonTabs[1].Groups[0].Items.Insert(0, item);
```




```vb
 Spreadsheet.CreateDefaultRibbonTabs(True)
 Dim item As New RibbonButtonItem("Download", "Download")
 Spreadsheet.RibbonTabs(1).Groups(0).Items.Insert(0, item)

```


<p>Â Since it is not possible to download a document on a callback request (seeÂ <a href="https://www.devexpress.com/Support/Center/p/T135686">Why it is impossible to download files on callbacks</a>),Â a ribbon item shouldÂ send a postback. For this, use theÂ <a href="https://www.codeproject.com/Articles/667531/doPostBack-function">__doPostBack</a> function in the client-sideÂ <a href="https://documentation.devexpress.com/AspNet/DevExpress.Web.ASPxSpreadsheet.Scripts.ASPxClientSpreadsheet.CustomCommandExecuted.event">ASPxClientSpreadsheet.CustomCommandExecuted</a> event handler:</p>


```js
 function onCustomCommandExecuted(s,e) {
            if (e.commandName == "Download") 
                __doPostBack("DownloadExcel");
 }

```


<p>Â </p>
<p>ASPxSpreadsheet in this example loads data from a database, so the default file dialogs are disabled: see theÂ <a href="https://documentation.devexpress.com/AspNet/117677/Common-Concepts/Office-Document-Management/Document-Loading">Office Document Management > Document Loading</a>Â article.</p>
<p><strong>NOTE:</strong><br>A cell doesn't get the value an end-user entered until the user clicks Enter or tabs out of this cell. As a result the issue with saving an entered value may occur if the value was not submitted.<p>In v18.1 we introduced the <a href="https://docs.devexpress.com/AspNet/js-ASPxClientSpreadsheet.ApplyCellEdit">ASPxClientSpreadsheet.ApplyCellEdit</a> method to force submission of the last entered value.</p>
<br/>


